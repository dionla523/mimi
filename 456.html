<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>ä»Šå¤©æœ‰æ²’æœ‰é²åˆ°ï¼Ÿ</title>
  <style>
    body { font-family: sans-serif; text-align: center; margin-top: 50px; }
    button { font-size: 1.2em; margin: 10px; padding: 10px 30px; }
    #result { margin-top: 30px; font-size: 1.5em; }
    #recordTableContainer { margin-top: 40px; display: none; }
    table { margin: 0 auto; border-collapse: collapse; }
    th, td { border: 1px solid #aaa; padding: 8px 16px; }
  </style>
</head>
<body>
  <h1>ä»Šå¤©æœ‰æ²’æœ‰é²åˆ°ï¼Ÿ</h1>
  <div id="date"></div>
  <button onclick="setStatus('onTime')">æº–æ™‚</button>
  <button onclick="setStatus('late')">é²åˆ°</button>
  <div id="result"></div>

  <div>
    <button id="viewRecordsBtn">æŸ¥çœ‹é²åˆ°ç´€éŒ„</button>
  </div>
  <div id="recordTableContainer">
    <h3>é²åˆ°ç´€éŒ„</h3>
    <table>
      <thead>
        <tr>
          <th>æ—¥æœŸ</th>
          <th>ç‹€æ…‹</th>
        </tr>
      </thead>
      <tbody id="recordTableBody"></tbody>
    </table>
  </div>

  <script>
    function getToday() {
      const now = new Date();
      const yyyy = now.getFullYear();
      const mm = String(now.getMonth() + 1).padStart(2, '0');
      const dd = String(now.getDate()).padStart(2, '0');
      return `${yyyy}-${mm}-${dd}`;
    }

    document.getElementById('date').innerText = 'ä»Šå¤©æ—¥æœŸï¼š' + getToday();

    function showStatus() {
      const today = getToday();
      const status = localStorage.getItem('status-' + today);
      const result = document.getElementById('result');
      if (status === 'onTime') {
        result.innerText = 'ä½ ä»Šå¤©æº–æ™‚ï¼ğŸ‘';
      } else if (status === 'late') {
        result.innerText = 'ä½ ä»Šå¤©é²åˆ°äº†ï¼â°';
      } else {
        result.innerText = 'å°šæœªç´€éŒ„ä»Šå¤©çš„ç‹€æ…‹ã€‚';
      }
    }

    function setStatus(status) {
      const today = getToday();
      localStorage.setItem('status-' + today, status);
      showStatus();
    }

    // æŸ¥çœ‹ç´€éŒ„åŠŸèƒ½
    const viewRecordsBtn = document.getElementById('viewRecordsBtn');
    const recordTableContainer = document.getElementById('recordTableContainer');
    const recordTableBody = document.getElementById('recordTableBody');

    viewRecordsBtn.addEventListener('click', () => {
      // å–å¾—æ‰€æœ‰ localStorage çš„é²åˆ°ç´€éŒ„
      const records = [];
      for (let i = 0; i < localStorage.length; i++) {
        const key = localStorage.key(i);
        if (key.startsWith('status-')) {
          const date = key.replace('status-', '');
          const status = localStorage.getItem(key);
          records.push({ date, status });
        }
      }
      // ä¾æ—¥æœŸæ’åºï¼ˆæ–°åˆ°èˆŠï¼‰
      records.sort((a, b) => b.date.localeCompare(a.date));
      // æ¸…ç©ºè¡¨æ ¼
      recordTableBody.innerHTML = '';
      // å¡«å…¥è³‡æ–™
      if (records.length === 0) {
        recordTableBody.innerHTML = '<tr><td colspan="2">å°šç„¡ç´€éŒ„</td></tr>';
      } else {
        for (const rec of records) {
          let statusText = rec.status === 'onTime' ? 'æº–æ™‚' : (rec.status === 'late' ? 'é²åˆ°' : rec.status);
          recordTableBody.innerHTML += `<tr><td>${rec.date}</td><td>${statusText}</td></tr>`;
        }
      }
      // é¡¯ç¤º/éš±è—è¡¨æ ¼
      recordTableContainer.style.display = recordTableContainer.style.display === 'none' ? 'block' : 'none';
    });

    showStatus();
  </script>
</body>
</html>